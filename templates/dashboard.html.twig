{% extends 'base.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/datatables/dataTables.bootstrap4.min.css') }}">
    <link rel="stylesheet" href="{{ asset('css/datatables/buttons.bootstrap4.min.css') }}">
    <link rel="stylesheet" href="{{ asset('css/datatables/responsive.dataTables.min.css') }}">
{% endblock %}

{% block sectiontitle %}Página principal{% endblock %}

{% block body %}
{{ parent() }}
    <div class="content mt-3">
        <div class="animated fadeIn">
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-body">
                            <table id="bootstrap-data-table-export" class="table table-striped table-bordered text-center">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Tipo</th>
                                    <th>Inmueble</th>
                                    <th>Constructor</th>
                                    <th>Arquitecto</th>
                                    <th>Arquitecto técnico</th>
                                    <th>Fecha inicio</th>
                                    <th>Días de obra</th>
                                    <th>Progreso</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for project in projects %}
                                    <tr>
                                        <td>{{ project.id }}</td>
                                        <td>{{ project.type }}</td>
                                        <td>{{ project.address }} ({{ project.city }})</td>
                                        <td>{{ project.builder.name }}</td>
                                        <td>{{ project.architect.name }}</td>
                                        <td>{{ project.technicalArchitect.name }}</td>
                                        <td>{{ project.startDate|date("d/m/Y") }}</td>
                                        <td>{{ project.constructionTime }}</td>
                                        <td class="w-25" style="vertical-align: middle;">
                                            <div class="progress" style="height: 24px;">
                                                {% if project.certificationReports|length > 0 %}
                                                    {% if project.type == "4x25" %}
                                                        {% if project.certificationReports|last.checkOrder == 1 and project.certificationReports|last.finished %}
                                                            <div class="progress-bar bg-danger" role="progressbar" style="width: 25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
                                                        {% elseif project.certificationReports|last.checkOrder == 2 and project.certificationReports|last.finished %}
                                                            <div class="progress-bar bg-warning" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100">50%</div>
                                                        {% elseif project.certificationReports|last.checkOrder == 3 and project.certificationReports|last.finished %}
                                                            <div class="progress-bar bg-info" role="progressbar" style="width: 75%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100">75%</div>
                                                        {% elseif project.certificationReports|last.checkOrder == 4 and project.certificationReports|last.finished %}
                                                            <div class="progress-bar bg-success" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">100%</div>
                                                        {% endif %}
                                                    {% elseif project.type == "15/30/40/15" %}
                                                        {% if project.certificationReports|last.checkOrder == 1 and project.certificationReports|last.finished %}
                                                            <div class="progress-bar bg-danger" role="progressbar" style="width: 15%" aria-valuenow="15" aria-valuemin="0" aria-valuemax="100">15%</div>
                                                        {% elseif project.certificationReports|last.checkOrder == 2 and project.certificationReports|last.finished %}
                                                            <div class="progress-bar bg-warning" role="progressbar" style="width: 45%" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100">45%</div>
                                                        {% elseif project.certificationReports|last.checkOrder == 3 and project.certificationReports|last.finished %}
                                                            <div class="progress-bar bg-info" role="progressbar" style="width: 85%" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100">85%</div>
                                                        {% elseif project.certificationReports|last.checkOrder == 4 and project.certificationReports|last.finished %}
                                                            <div class="progress-bar bg-success" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">100%</div>
                                                        {% endif %}
                                                    {% endif %}
                                                {% else %}
                                                    <div class="progress-bar bg-danger" role="progressbar" style="width: 0" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                                                {% endif %}
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('js/datatables/jquery.dataTables.min.js') }}"></script>
    <script src="{{ asset('js/datatables/dataTables.bootstrap4.min.js') }}"></script>
    <script src="{{ asset('js/datatables/dataTables.buttons.min.js') }}"></script>
    <script src="{{ asset('js/datatables/dataTables.responsive.min.js') }}"></script>
    <script src="{{ asset('js/datatables/buttons.bootstrap4.min.js') }}"></script>
    <script src="{{ asset('js/datatables/buttons.html5.min.js') }}"></script>
    <script src="{{ asset('js/datatables/buttons.print.min.js') }}"></script>
    <script src="{{ asset('js/datatables/buttons.colVis.min.js') }}"></script>
    <script src="{{ asset('js/datatables-init.js') }}"></script>
{% endblock %}